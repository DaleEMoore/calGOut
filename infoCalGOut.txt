infoCalGOut.txt

Overview
Calendar Google Out to Quick Books, Quicken, OpenERP, Odoo or some other invoicing program.

Keep your scheduled events in Google Calendar, perform the events, then bill for the time.
get and install google gdata.

DEV; in pyCharm run main.py.

python27\scripts\pip install --upgrade google-api-python-client
https://code.google.com/p/google-api-python-client/downloads/list

How do I implement code?
    Find google_calendar_API_v3_1.pyc and copy to production?
    Copy to smb://192.168.1.2/c$/Shares/Shared/Access/InvoiceExports
    Backup google_calendar_API_v3_1.py and .pyc to C:\Users\dalem\PycharmProjects\calGOut\old
    Then move to C:\Users\dalem\PycharmProjects\calGOut
    Try it.



TODOs
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 67: ordinal not in range(128)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 67: ordinal not in range(128)
    Bad character in some record from Google.
    Display line after read so I know which line is in error.
    http://stackoverflow.com/questions/9942594/unicodeencodeerror-ascii-codec-cant-encode-character-u-xa0-in-position-20
    .encode('utf-8').strip()
    Message: 'ascii' codec can't decode byte 0xc2 in position 67: ordinal not in range(128)
    http://stackoverflow.com/questions/21129020/how-to-fix-unicodedecodeerror-ascii-codec-cant-decode-byte
    Try except error and display which calendar description is failing.
    I MIGHT have fixed the problem, but; it doesn't display that there was a data error; I think. So I've commented
    out the code and expect that when I encounter the next data error I will be able to make it display.

Make the code self-updating except when (major.minor.miniscule) major or minor? changes.

Save the default values so it's customized to the installed instance.

Launch it from a Desktop ICON.
    Python Launcher for Windows (Console) Python Software Foundation.
    (Instead of python.exe.) It looks like it's launching idea.
    C:\Users\dalem\PycharmProjects\calGOut\main.py
    C:\Users\dalem\PycharmProjects\calGOut


Make the UI more obvious.
    Tell me when it's done processing, or launch Excel.

Preview CSV output in form allowing EXPORT check-box for inclusion.
Export EXPORT checked items to a QuickBooks formatted file.
    Like TimerMW1.IIF:
!TIMERHDR	VER	REL	COMPANYNAME	IMPORTEDBEFORE	FROMTIMER	COMPANYCREATETIME
TIMERHDR	6	0	Moore Works	N	Y	915135124
!TIMEACT	DATE	JOB	EMP	ITEM	PITEM	DURATION	PROJ	NOTE	XFERTOPAYROLL	BILLINGSTATUS	GUID
TIMEACT	12/31/2014	Medical Reimbursement                             	Moore, Dale E                                     	Hrs 125		1		(12/31/2014) 001 PC Michelle power supply repairs                                                                                                                                                                                                              	N	1	203
TIMEACT	1/1/2015	Berridge Manufacturing Company                    	Moore, Dale E                                     	Hrs 125		6.5		(1/1/2015) 001 TEST site DNS failing on some pages, email MS Exchange research, product-picture-slider training                                                                                                                                                	N	1	204
TIMEACT	1/2/2015	Berridge Manufacturing Company                    	Moore, Dale E                                     	Hrs 125		1		(1/2/2015) 001 Researching WordPress email to MS Exchange failing                                                                                                                                                                                              	N	1	205
TIMEACT	1/5/2015	LF Incassable LLC                                 	Moore, Dale E                                     	Hrs 125		2		(1/5/2015) 001 User and company account access, user account RDP setup                                                                                                                                                                                         	N	1	206
TIMEACT	1/5/2015	Berridge Manufacturing Company                    	Moore, Dale E                                     	Hrs 125		1.5		(1/5/2015) 001 Product-picture-slider research                                                                                                                                                                                                                 	N	1	207
    Find out NEW QB IIF format and start using that.
Add column names in CSV output.
Make it prettier.
Make simple Linux, MAC and Windows installer.

setup.py might be needed to install all the requirements in the VirtualEnvironment.
    If not dateutil.tz then run setup.py to get everything?
    sudo pip install python-dateutil --upgrade
    sudo pip install pytz --upgrade



Logs
Thursday 14 August 2014 11:44 PM CST
Created


Monday 8 September 2014 5:05 PM CST
Capture recent time from the calendar.
    Use enter2, or enter3 to capture account, password, calendar, start_date, end_date, filter.
        Remember them for next run.
    Access Google Calendar via API?
        https://github.com/tpopela/google_calendar_fetcher
        Python3, google_calendar_fetcher gets it, yea!
        https://github.com/search?utf8=%E2%9C%93&q=google+calendar+python&type=Repositories&ref=searchresults
        https://developers.google.com/api-client-library/python/start/get_started
        https://developers.google.com/api-client-library/python/samples/samples#Calendar_API
        https://developers.google.com/google-apps/calendar/v2/developers_guide_python (Deprecated but Python examples.)
        https://developers.google.com/google-apps/calendar/
        https://developers.google.com/google-apps/calendar/v1/developers_guide_python
        https://developers.google.com/google-apps/calendar/v2/developers_guide_python
    Output events to CSV
        to Quick Books
        to Quicken

Tuesday 25 November 2014 8:18 AM CST
gcalcli.py
# From https://raw.githubusercontent.com/insanum/gcalcli/master/gcalcli
calGOut gcalcli.py
dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py agenda

Sat Nov 22           Blake and Kids in SA

Tue Nov 25           Robbie in sa
             5:00am  Moore Works Recycling pickup day
             7:00am  Dale's Day; do what you want.
             9:00am  ?Jack George at Moore works
            11:30am  Lunch
            12:00pm  Lunch
             1:30pm  Check on SSFCU to Wells Fargo External account
             1:30pm  Cover DaleHome Kitchen
             6:00pm  Check Investments; use Google Stocks?
             6:00pm  Clean toilets for Olivia
             6:30pm  Steve Aronstein is home from walking the neighbor's dog.

Wed Nov 26           Jo Anne Thomas's birthday
                     Emily Nicole Rogers's birthday
             8:00am  Drain hot water heater for 10 seconds
             8:30am  Change A/C Filter or does the CPS thermostat tell me when?; Clorox A/C drain line
             9:00am  All; MW billing, staff, programming
             9:00am  Dale; Pay DaleEMoore eMail yellow-exclamation marked
             9:00am  ?Jack George at Moore works
             9:00am  Quest Diagnostics overpaid
             9:00am  Change a/c filter home 14x25x1, mw 16x25x1; Change A/C Filter or does the CPS thermostat tell me when?; Clorox A/C drain line
            10:00am  Keep Westar billing to less than 20 hours/month, about 4 hours/week
            10:00am  Fix Abdo Complimentary Credit from last week!
            11:30am  OFOWC
             6:30pm  Steve Aronstein is home from walking the neighbor's dog.

Thu Nov 27           Thanksgiving day.
                     Thanksgiving Day (QC Holiday)
                     Thanksgiving Day
             5:00am  Bill $ $2,081.99/week = 16.66 hours (cover Moore Works expenses)
             8:00am  Joanie and Dale in Austin
            10:00am  Thanksgiving To Austin
            11:00am  Thanksgiving in Austin
             4:00pm  Mom early TDay dinner with Judy
             6:30pm  Steve Aronstein is home from walking the neighbor's dog.

Fri Nov 28           Day after Thanksgiving Day (QC Holiday)
                     Don Williams's birthday
             5:00am  Moore Works Garbage pickup day
             9:00am  ?Jack George at Moore works
             6:30pm  Steve Aronstein is home from walking the neighbor's dog.
             8:00pm  Thanksgiving To San Antonio

Sat Nov 29           Maile Kono-Wells bday
                     Terry Ross's birthday
             8:00am  To/From Austin Grandchildren
             6:30pm  Steve Aronstein is home from walking the neighbor's dog.

It looks like I've found the google-python-api v3 example I needed.

Thu 27 Nov 2014 10:07 PM CST
On Bonnie Purser's machine in Austin at Joey's where we've just fixed it not booting.
    I installed PyCharm and calGOut and in just a few minutes had
    calGOut running with tkinter and
    gcalcli running.
    YEAH!


Mon 1 Dec 2014 4:20 PM CST
/usr/bin/python2.7 /home/dalem/PycharmProjects/calGOut/gcalcli.py agenda 11/22/14 11/26/14
    Gives me lots of what I want.
    What if I want to run against a different Google account?
    Can gcalcli.py do everything I need?
    Evaluate gcalcli.py's gflags usage for options that give me what I want.

    gcalcli.py agenda 11/22/14 11/26/14
    gcalcli.py search "bill" agenda 11/22/14 11/26/14
    invalid search string.
    gcalcli.py search "bill"
    case insensitive
    remove special formatting, make CSV or TSV?
        [0m[0;33m
        2000-05-20[0m[0;36m   7:00pm  Playful Ritual
    remove multiple instances of the same event output.

    --nocolor
    --detail_all

    dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py search "bill" --nocolor --detail_all > t1.txt
    dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py search "bill" --nocolor > t1.txt
    dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py agenda 11/12/14 11/26/14 | grep -i bill
    dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py agenda 11/12/14 11/26/14 --details all | less
    dalem@QnD:~/PycharmProjects/calGOutâŸ« python ./gcalcli.py agenda 11/12/14 11/26/14 --details calendar --details length --nocolor | less
    not on a single line, hard to parse and import.

/usr/bin/python2.7 /home/dalem/PycharmProjects/calGOut/gcalcli.py csv 11/22/14 11/26/14
    Make it output what I want when I want it.


https://developers.google.com/google-apps/calendar/v1/developers_guide_dotnet
    This API is a subject to the Deprecation Policy and will be shutdown on November 17, 2014. Please use APIv3 instead.
    https://developers.google.com/google-apps/calendar/
    Google Calendar API v3
    https://developers.google.com/google-apps/calendar/v3/reference/calendars/get
    Python Client Library
    https://code.google.com/p/google-api-python-client/
    https://developers.google.com/google-apps/calendar/migration

    https://developers.google.com/google-apps/calendar/setup
    https://developers.google.com/google-apps/calendar/instantiate


Fri 5 Dec 2014 7:23 AM CST
Shifting from command-line date strings to calculated last-2-weeks date strings is failing.
    Figure out how to get last-2-weeks into command-line acceptible format.

Make main.py run it.
Change tkinter options page to have key fields.

Thu 4 Dec 2014 9:06 AM CST
setup.py might be needed to install all the requirements in the VirtualEnvironment.
    If not dateutil.tz then run setup.py to get everything?
    sudo pip install python-dateutil --upgrade
    sudo pip install pytz --upgrade

    requirements.txt contains everything I need for PyCharm to install.

Wed 3 Jun 2015 9:27 AM CST
Change the default ['Search String'] from "Bill" to "Bill " so I avoid stuff like "billable" and "billing".


Wed 10 August 2016 7:33 AM CST
oauth2client.client.AccessTokenRefreshError: invalid_grant
    Trying to fix a bug when running as guest1@Mercury.
    http://stackoverflow.com/questions/23918443/got-invalid-grant-in-oauth2-signedjwtassertioncredentials
    This MIGHT been because I'd not git pull-ed the most recent code.
    Fixed buy git pull-ing the most recent code!

